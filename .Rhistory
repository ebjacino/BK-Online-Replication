summarise(bias = sum(sharp_shape_choice)/n())
View(data_consonant)
View(data_congruency)
View(all_data_df)
age_table <- read_excel("bko2 age table.xlsx")
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(forcats)
library(bbmle)      # for ICtab()
library(car)        # for Anova()
library(readxl)
library("writexl")
age_table <- read_excel("bko2 age table.xlsx")
all_data_df <- full_join(all_data_df,age_table, by="ID")
#CALCULATE CHOICE BIAS
#group_by(ID,sound,group) group for when i have both adults and children
data_orth <- all_data_df %>% group_by(ID,sound) %>%
summarise(bias = sum(correct)/n())
data_all_sounds <- all_data_df %>% group_by(ID,sound,stimulus) %>%
summarise(bias = sum(correct)/n())
data_vowel_type <- all_data_df %>% group_by(vowel_type, ID) %>%
summarise(bias = sum(correct)/n())
data_congruency = all_data_df %>% group_by(congruent, ID) %>%
summarise(bias = sum(correct)/n())
data_voicing = all_data_df %>% group_by(voicing, ID) %>%
summarise(bias = sum(correct)/n())
data_consonant = all_data_df %>% group_by(consonant_type, ID) %>%
summarise(bias = sum(correct)/n())
#data_consonant_type = all_data_df_c %>% group_by(consonant_type, ID) %>%
#summarise(bias = sum(sharp_shape_choice)/n())
#listing comparisons for significance bars
#bias for orthography
orth_comparisons <- list( c("angular", "curved"))
#bias for vowel type
vowel_comparisions <- list( c("/a/", "/i/"))
#bias for congruency
congruency_comparisions <- list( c("congruent", "incongruent"))
#bias for voicing
voicing_comparisions <- list( c("unvoiced", "voiced"))
#bias for consonant type
consonant_comparisons <- list( c("stop", "fricative"),
c("fricative", "sonorant"),
c("stop", "sonorant"))
stimulus_bias_data <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(stimulus,sound) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n())) %>%
ungroup() %>%
mutate(stimulus = fct_reorder2(stimulus, sound, mean_bias))
stimulus_bias_data_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.25)) %>%
group_by(stimulus,sound,bias_round) %>%
summarise(Count = n())
new_color_all_stim <- ggplot() +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias), color = "black", fill = NA) +
geom_point(stimulus_bias_data_points, mapping =aes(x = stimulus, y = bias_round, size = Count, color= sound)) +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias)) +
geom_errorbar(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
theme_classic() +
ylim(-0.5,0.5) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
ylab("Choice Bias") +
xlab("Stimulus")
new_color_all_stim
#ggsave("graphs/presentation graphs/kids_all_stim.png", width = 10, height = 5)
View(stimulus_bias_data_points)
View(stimulus_bias_data)
stimulus_bias_data_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.1)) %>%
group_by(stimulus,sound,bias_round) %>%
summarise(Count = n())
stimulus_bias_data_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
#mutate(bias_round = round_any(bias,0.25)) %>%
group_by(stimulus,sound,bias) %>%
summarise(Count = n())
new_color_all_stim <- ggplot() +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias), color = "black", fill = NA) +
geom_point(stimulus_bias_data_points, mapping =aes(x = stimulus, y = bias, size = Count, color= sound)) +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias)) +
geom_errorbar(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
theme_classic() +
ylim(-0.5,0.5) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
ylab("Choice Bias") +
xlab("Stimulus")
new_color_all_stim
#ggsave("graphs/presentation graphs/kids_all_stim.png", width = 10, height = 5)
stimulus_bias_data_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) #%>%
stimulus_bias_data <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) #%>%
stimulus_bias_data <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) #%>%
View(all_data_df)
stimulus_bias_data <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() ) #%>%
stimulus_bias_data <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(stimulus,sound) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n())) %>%
ungroup() %>%
mutate(stimulus = fct_reorder2(stimulus, sound, mean_bias))
stimulus_bias_data_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.5)) %>%
group_by(stimulus,sound,bias) %>%
summarise(Count = n())
new_color_all_stim <- ggplot() +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias), color = "black", fill = NA) +
geom_point(stimulus_bias_data_points, mapping =aes(x = stimulus, y = bias_round, size = Count, color= sound)) +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias)) +
geom_errorbar(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
theme_classic() +
ylim(-0.5,0.5) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
ylab("Choice Bias") +
xlab("Stimulus")
new_color_all_stim
stimulus_bias_data_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.5)) %>%
group_by(stimulus,sound,bias) %>%
summarise(Count = n())
new_color_all_stim <- ggplot() +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias), color = "black", fill = NA) +
geom_point(stimulus_bias_data_points, mapping =aes(x = stimulus, y = bias_round, size = Count, color= sound)) +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias)) +
geom_errorbar(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
theme_classic() +
ylim(-0.5,0.5) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
ylab("Choice Bias") +
xlab("Stimulus")
new_color_all_stim
stimulus_bias_data_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.5)) %>%
group_by(stimulus,sound,bias) %>%
summarise(Count = n())
stimulus_bias_data_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.5)) %>%
group_by(stimulus,sound,bias) %>%
summarise(Count = n())
stimulus_bias_data_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.25)) %>%
group_by(stimulus,sound,bias) %>%
summarise(Count = n())
stimulus_bias_data_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.25)) %>%
group_by(stimulus,sound,bias) %>%
summarise(Count = n())
View(stimulus_bias_data_points)
new_color_all_stim <- ggplot() +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias), color = "black", fill = NA) +
geom_point(stimulus_bias_data_points, mapping =aes(x = stimulus, y = bias, size = Count, color= sound)) +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias)) +
geom_errorbar(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
theme_classic() +
ylim(-0.5,0.5) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
ylab("Choice Bias") +
xlab("Stimulus")
new_color_all_stim
#ggsave("graphs/presentation graphs/kids_all_stim.png", width = 10, height = 5)
new_color_all_stim <- ggplot() +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias), color = "black", fill = NA) +
geom_point(stimulus_bias_data_points, mapping =aes(x = stimulus, y = bias, size = Count, color= sound)) +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias)) +
geom_errorbar(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
theme_classic() +
ylim(-0.5,0.5) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
ylab("Choice Bias") +
xlab("Stimulus") +
facet_wrap("Range")
new_color_all_stim
stimulus_bias_data <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(stimulus,sound,Range) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n())) %>%
ungroup() %>%
mutate(stimulus = fct_reorder2(stimulus, sound, mean_bias))
stimulus_bias_data <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(stimulus,sound,Range) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n())) %>%
ungroup() %>%
mutate(stimulus = fct_reorder2(stimulus, sound, mean_bias))
stimulus_bias_data <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound,Range) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(stimulus,sound,Range) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n())) %>%
ungroup() %>%
mutate(stimulus = fct_reorder2(stimulus, sound, mean_bias))
View(stimulus_bias_data)
stimulus_bias_data <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound,Range) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(stimulus,sound,Range) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n())
n = n()) %>%
stimulus_bias_data <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound,Range) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(stimulus,sound,Range) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n()),
N = n()) %>%
ungroup() %>%
mutate(stimulus = fct_reorder2(stimulus, sound, mean_bias))
stimulus_bias_data_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,stimulus,sound,Range) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.25)) %>%
group_by(stimulus,sound,bias) %>%
summarise(Count = n())
new_color_all_stim <- ggplot() +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias), color = "black", fill = NA) +
geom_point(stimulus_bias_data_points, mapping =aes(x = stimulus, y = bias, size = Count, color= sound)) +
geom_col(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias)) +
geom_errorbar(stimulus_bias_data, mapping = aes(x = stimulus, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
theme_classic() +
ylim(-0.5,0.5) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
ylab("Choice Bias") +
xlab("Stimulus") +
facet_wrap("Range")
new_color_all_stim
#ggsave("graphs/presentation graphs/kids_all_stim.png", width = 10, height = 5)
orth_new <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,sound,Range) %>%
summarise(bias = sum(correct)/n()) %>%
#mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(sound,Range) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n()))
orth_new_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,sound,Range) %>%
summarise(bias = sum(correct)/n()) %>%
ungroup() %>%
#mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.25)) %>%
group_by(sound,bias_round) %>%
summarise(Count = n())
new_orthography <- ggplot(data_orth, aes(x = sound, y = bias)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias), color = "black", fill = NA) +
geom_point(orth_new_points, mapping = aes(x = sound, y = bias_round, size = Count, color = sound)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(orth_new, mapping = aes(x = sound, y = mean_bias)) +
geom_errorbar(orth_new, mapping = aes(x = sound, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1, width = 0.5) +
stat_compare_means(comparisons = orth_comparisons, label.y = c(1.2),
label = "p.signif", hide.ns = FALSE) +
theme_classic() +
ylim(0, 1.5) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
scale_size_continuous(breaks = c(5, 10, 15)) +
ylab("Choice Bias") +
xlab("Sound") +
facet_wrap("Range")
new_orthography
orth_new <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,sound,Range) %>%
summarise(bias = sum(correct)/n()) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(sound,Range) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n()))
orth_new_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,sound,Range) %>%
summarise(bias = sum(correct)/n()) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.25)) %>%
group_by(sound,bias_round) %>%
summarise(Count = n())
new_orthography <- ggplot(data_orth, aes(x = sound, y = bias)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias), color = "black", fill = NA) +
geom_point(orth_new_points, mapping = aes(x = sound, y = bias_round, size = Count, color = sound)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(orth_new, mapping = aes(x = sound, y = mean_bias)) +
geom_errorbar(orth_new, mapping = aes(x = sound, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1, width = 0.5) +
stat_compare_means(comparisons = orth_comparisons, label.y = c(1.2),
label = "p.signif", hide.ns = FALSE) +
theme_classic() +
ylim(0, 1.5) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
scale_size_continuous(breaks = c(5, 10, 15)) +
ylab("Choice Bias") +
xlab("Sound") +
facet_wrap("Range")
new_orthography
new_orthography <- ggplot(data_orth, aes(x = sound, y = bias)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias), color = "black", fill = NA) +
geom_point(orth_new_points, mapping = aes(x = sound, y = bias_round, size = Count, color = sound)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(orth_new, mapping = aes(x = sound, y = mean_bias)) +
geom_errorbar(orth_new, mapping = aes(x = sound, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1, width = 0.5) +
#stat_compare_means(comparisons = orth_comparisons, label.y = c(1.2),
#label = "p.signif", hide.ns = FALSE) +
theme_classic() +
ylim(0, 1.5) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
scale_size_continuous(breaks = c(5, 10, 15)) +
ylab("Choice Bias") +
xlab("Sound") +
facet_wrap("Range")
new_orthography
new_orthography <- ggplot(data_orth, aes(x = sound, y = bias)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias), color = "black", fill = NA) +
geom_point(orth_new_points, mapping = aes(x = sound, y = bias_round, size = Count, color = sound)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(orth_new, mapping = aes(x = sound, y = mean_bias)) +
geom_errorbar(orth_new, mapping = aes(x = sound, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1, width = 0.5) +
#stat_compare_means(comparisons = orth_comparisons, label.y = c(1.2),
#label = "p.signif", hide.ns = FALSE) +
theme_classic() +
ylim(-1, 1.5) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
scale_size_continuous(breaks = c(5, 10, 15)) +
ylab("Choice Bias") +
xlab("Sound") +
facet_wrap("Range")
new_orthography
new_orthography <- ggplot(data_orth, aes(x = sound, y = bias)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias), color = "black", fill = NA) +
geom_point(orth_new_points, mapping = aes(x = sound, y = bias_round, size = Count, color = sound)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(orth_new, mapping = aes(x = sound, y = mean_bias)) +
geom_errorbar(orth_new, mapping = aes(x = sound, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1, width = 0.5) +
#stat_compare_means(comparisons = orth_comparisons, label.y = c(1.2),
#label = "p.signif", hide.ns = FALSE) +
theme_classic() +
ylim(-1, 1) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
scale_size_continuous(breaks = c(5, 10, 15)) +
ylab("Choice Bias") +
xlab("Sound") +
facet_wrap("Range")
new_orthography
orth_new <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,sound,Range) %>%
summarise(bias = sum(correct)/n()) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(sound,Range) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n()))
orth_new <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,sound,Range) %>%
summarise(bias = sum(correct)/n()) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(sound,Range) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n()))
group_by(ID,stimulus,sound,Range) %>%
summarise(bias = sum(correct)/n() - 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
orth_new <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,sound,Range) %>%
summarise(bias = sum(correct)/n()- 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(sound,Range) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n()))
orth_new <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,sound,Range) %>%
summarise(bias = sum(correct)/n()- 0.5) %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
group_by(sound,Range) %>%
summarize(mean_bias = mean(bias),
sd_bias = sd(bias),
se_bias=sd_bias/sqrt(n()))
orth_new_points <- all_data_df %>% mutate(stimulus = toupper(sub(".wav","",sub("sound/","",stimulus)))) %>%
group_by(ID,sound,Range) %>%
summarise(bias = sum(correct)/n()- 0.5) %>%
ungroup() %>%
mutate(bias = ifelse(sound == "angular",-1*bias,bias)) %>%
mutate(bias_round = round_any(bias,0.25)) %>%
group_by(sound,bias_round) %>%
summarise(Count = n())
new_orthography <- ggplot(data_orth, aes(x = sound, y = bias)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias), color = "black", fill = NA) +
geom_point(orth_new_points, mapping = aes(x = sound, y = bias_round, size = Count, color = sound)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(orth_new, mapping = aes(x = sound, y = mean_bias)) +
geom_errorbar(orth_new, mapping = aes(x = sound, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1, width = 0.5) +
#stat_compare_means(comparisons = orth_comparisons, label.y = c(1.2),
#label = "p.signif", hide.ns = FALSE) +
theme_classic() +
ylim(-1, 1) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
scale_size_continuous(breaks = c(5, 10, 15)) +
ylab("Choice Bias") +
xlab("Sound") +
facet_wrap("Range")
new_orthography
new_orthography <- ggplot(data_orth, aes(x = sound, y = bias)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias), color = "black", fill = NA) +
geom_point(orth_new_points, mapping = aes(x = sound, y = bias_round, size = Count, color = sound)) +
geom_col(orth_new, mapping = aes(x = sound, y = mean_bias, fill = sound), alpha = 0.5) +
geom_point(orth_new, mapping = aes(x = sound, y = mean_bias)) +
geom_errorbar(orth_new, mapping = aes(x = sound, y = mean_bias, ymin = mean_bias-se_bias, ymax = mean_bias+se_bias), alpha = 1, width = 0.5) +
#stat_compare_means(comparisons = orth_comparisons, label.y = c(1.2),
#label = "p.signif", hide.ns = FALSE) +
theme_classic() +
ylim(-.5, .5) +
scale_fill_manual(values = c(angular_color,curved_color)) +
scale_color_manual(values = c(angular_color,curved_color)) +
scale_size_continuous(breaks = c(5, 10, 15)) +
ylab("Choice Bias") +
xlab("Sound") +
facet_wrap("Range")
new_orthography
